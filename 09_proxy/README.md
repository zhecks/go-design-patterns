# proxy

## 定义

为其他对象提供一种代理以控制对这个对象的访问

ps：控制的方式有很多，例如增加前置或后置操作，权限校验，虚代理等等

![image-20230817140245873](https://cdn.jsdelivr.net/gh/zhecks/static_resources/images/202308171402004.png)

![image-20230817140306779](https://cdn.jsdelivr.net/gh/zhecks/static_resources/images/202308171403014.png)

## 分类

* 虚代理：根据需要来创建开销很大的对象，该对象只有在需要的时候才会被真正创建
* 远程代理：用来在不同的地址空间上代表同一个对象，这个不同的地址空间可以是在本机，也可以在其他机器上
* copy-on-write代理：在客户端操作时，只有对象确实改变了，才会真正拷贝一个目标对象，算是虚代理的一个分支
* 保护代理：控制对原始对象的访问，如果有需要，可以给不同的用户提供不同的保护权限，以控制他们对原始对象的访问
* Cache代理：为那些昂贵操作的结果提供临时的存储空间，以便多个客户端可以共享这些结果
* 防火墙代理：保护对象不被恶意用户访问和操作
* 同步代理：使多个用户能够同时访问目标对象而没有冲突
* 智能指引：在访问对象时执行一些附加操作，比如，对指向实际对象的引用计数、第一次引用一个持久对象时，将它装入内存

## 思考

1. 代理模式的本质

代理模式的本质：控制对象访问（ps：通过控制对象访问来实现一系列额外的操作）

2. 何时选用代理模式

* 需要为一个对象在不同的地址空间提供局部代表的时候，可以使用远程代理
* 需要按照需要创建开销很大的对象的时候，可以使用虚代理
* 需要控制对原始对象的访问的时候，可以使用保护代理
* 需要在访问对象执行一些附加操作的时候，可以使用智能代理