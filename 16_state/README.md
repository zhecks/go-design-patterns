# state

## 定义

允许一个对象在其内部状态改变它的行为。对象看起来似乎修改了它的类

![image-20230818152053207](https://cdn.jsdelivr.net/gh/zhecks/static_resources/images/202308181520360.png)

## 优缺点

状态模式有以下优点

* 简化应用逻辑控制

状态模式使用单独的类来封装一个状态的处理。如果把一个大的程序控制分成很多小块，每块定义一个状态来代表，那么就可以把这些逻辑控制的代码分散到很多单独的状态类中取，这样就把着眼点从执行状态提高到整个对象的状态，使得代码结构化和意图更清晰，从而简化应用的逻辑控制

对于依赖于状态的if-else，理论上来讲，也可以改变程应用状态模式来实现，把每个if或else块定义一个状态来代表，那么就可以把块内的功能代码移动到状态处理类中，从而减少if-else，避免出现巨大的条件语句

* 更好地分离状态和行为

状态模式通过设置所有状态类的公共接口（ps：封装程公共接口只是为了管理类统一调用，实际上还是各个状态自己处理自己的），把状态和状态对应的行为分离开，把所有与一个特定的状态相关的行为都放入一个对象中，使得应用程序在控制的时候，只需要关心状态的切换，而不用关心这个状态对应的真正处理

* 更好的扩展性

引入了状态处理的公共接口后，使得扩展新的状态变得非常容易，只需要新增加一个实现状态处理的公共接口的实现类，然后在进行维护状态的地方，设置状态变化到这个新的状态即可

* 显示化进行状态转换

状态模式为不同的状态引入独立的对象，使得状态的转换变得更加明确。而且状态对象可以保证上下文不会发生内部状态不一致的情况，因为上下文中只有一个变量来记录状态对象，只要为这个变量赋值就可以了

状态模式的缺点

一个状态对应一个状态处理类，会使得程序引入太多的状态类，这样程序变得杂乱

ps：不用状态模式一样会有这个问题

## 思考

1. 状态模式的本质

状态模式的本质：根据状态来分离和选择行为

ps：将状态转化通过具体的状态实现类进行

2. 何时选用状态模式

*

如果一个对象的行为取决于它的状态，而且它必须在运行时刻根据状态来改变它的行为，可以使用状态模式，来把状态和行为分离开。虽然分离开了，但状态和行为是有对应关系的，可以在运行期间，通过改变状态，就能够调用到该状态对应的状态处理对象上去，从而改变对象的行为

* 如果一个操作中含有庞大的多分支语句，而且这些分支依赖于该对象的状态，可以使用状态模式，把各个分支的处理分散包装到单独的对象处理类中，这样，这些分支对应的对象就可以不依赖于其他对象而独立变化了